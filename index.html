<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <!-- <script src="/script.js"></script> -->
    <title>Document</title>
</head>

<body>

    <span id="colorPicker">
        <select name="selectColor" id="selectPicker">


        </select>
        <div class="helpRGB"></div>

        <div id="slider">
            <div class="line">
                <div class="rele" id="red"></div>
            </div>

            <div class="line">
                <div class="rele" id="green"></div>
            </div>

            <div class="line">
                <div class="rele" id="blue"></div>
            </div>
            <!-- <div id="count"></div>
            <div id="rgbColor"></div> -->
        </div>
    </span>





    <script>
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        function hexToRgb(hex) {
            var bigint = parseInt(hex, 16);
            var r = (bigint >> 16) & 255;
            var g = (bigint >> 8) & 255;
            var b = bigint & 255;

            return r + "," + g + "," + b;
        }

        let select = document.getElementById("selectPicker");

        let colorMap = new Map();

        colorMap.set("#FF0000", "red");
        colorMap.set("#00FF00", "green");
        colorMap.set("#0000FF", "blue");
        colorMap.set("#000000", "black");
        colorMap.set("#FFFFFF", "white");

        colorMap.forEach((value, key, map) => {
            let newOption = new Option(value, key);
            select.append(newOption);
        });

        var redS = 0;
        var greenS = 0;
        var blueS = 0;

        select.options[3].selected = true;
        var rgbColor = document.querySelector(".helpRGB");
        rgbColor.style.backgroundColor = `${select.value}`;

        select.addEventListener("change", function(event){
            rgbColor.style.backgroundColor = `${select.value}`;
            let colorArr = hexToRgb(select.value).split(',').map(value => value.trim());
            redS = colorArr[0];
            greenS = colorArr[1];
            blueS = colorArr[2];
        });


        rgbColor.addEventListener("click", function () {

            var currentPos = 0;
            var minCount = 0;
            var Count = 255;

            var reles = document.querySelectorAll(".rele");
            var line = document.querySelector(".line");

            // var count = document.getElementById("count");
            var slider = document.getElementById("slider");



            var rightEdge = line.offsetWidth - reles[0].offsetWidth;

            // for (let rele of reles) {
            //     rele.style.left = ((currentPos - minCount) * rightEdge) / Count + "px";
            // }



            //  slider.style.display = true;
            // if (slider.hidden) {
            //     slider.hidden = false;

            // } else {
            //     slider.hidden = true;
            // }


            slider.onmousedown = function (event) {
                var colorSlider = event.target;

                var shiftX = event.pageX - colorSlider.offsetLeft;
                document.onmousemove = function (event) {

                    let newLeft = event.pageX - shiftX - line.offsetLeft;
                    if (newLeft < 0) { newLeft = 0; }
                    if (newLeft > rightEdge) {
                        newLeft = rightEdge;
                    }

                    let tempValue = Math.round((newLeft / rightEdge) * Count);

                    switch (colorSlider.id) {
                        case "red":
                            redS = tempValue;
                            break;
                        case "green":
                            greenS = tempValue;
                            break;
                        case "blue":
                            blueS = tempValue;
                            break;
                        case "count":
                            return false;
                            break;
                        case "rgbColor":
                            return false;
                            break;
                    }

                    //count.textContent = `(${redS}, ${greenS}, ${blueS})`;
                    colorSlider.style.left = newLeft + 'px';

                    rgbColor.style.background = `rgb(${redS}, ${greenS}, ${blueS})`;

                }
                document.onmouseup = function () {
                    document.onmousemove = document.onmouseup = null;
                };
            };

        });







    </script>

</body>

</html>